(function(t){var e=function t(){for(var e=arguments.length,n=Array(e),f=0;f<e;f++)n[f]=arguments[f];var o=void 0,a=void 0;return"boolean"==typeof n[0]?(o=[].slice.call(n,1),a=n[0]):o=[].slice.call(n),o.forEach(function(e){e instanceof Object?Object.keys(e).forEach(function(n){return o[0][n]=a?t(a,{},e[n]):e[n]}):o[0]=e}),o[0]},n=function(t,e){var n=[],o=new DataView(new ArrayBuffer(f(t,n,e)));return n.forEach(function(t){o["set"+t.type](t.offset,t.val)}),o},f=function t(e,n,f){return f instanceof Array&&n.push({val:f.length,type:"Uint8",offset:e++}),f instanceof Array&&f[0]instanceof Object?f.forEach(function(f){return e=t(e,n,f)}):Object.keys(f).sort().forEach(function(o){var a=void 0,i=!1;f[o]instanceof Object?e=t(e,n,f[o]):"number"==typeof f[o]?(n.push({val:f[o]}),a=n[n.length-1],f[o]%1||(i=f[o]<Math.pow(-2,31)||f[o]>Math.pow(2,32)-1)?!i&&f[o]>=-3.4e38&&f[o]<=3.4e38?(n.splice(n.length-1,0,{val:6,type:"Uint8",offset:e++}),a.type="Float32",a.offset=e,e+=4):(n.splice(n.length-1,0,{val:7,type:"Uint8",offset:e++}),a.type="Float64",a.offset=e,e+=8):f[o]>=0?f[o]<Math.pow(2,8)?(n.splice(n.length-1,0,{val:0,type:"Uint8",offset:e++}),a.type="Uint8",a.offset=e,e+=1):f[o]<Math.pow(2,16)?(n.splice(n.length-1,0,{val:2,type:"Uint8",offset:e++}),a.type="Uint16",a.offset=e,e+=2):f[o]<Math.pow(2,32)&&(n.splice(n.length-1,0,{val:4,type:"Uint8",offset:e++}),a.type="Uint32",a.offset=e,e+=4):f[o]>Math.pow(-2,7)?(n.splice(n.length-1,0,{val:1,type:"Uint8",offset:e++}),a.type="Int8",a.offset=e,e+=1):f[o]>Math.pow(-2,15)?(n.splice(n.length-1,0,{val:3,type:"Uint8",offset:e++}),a.type="Int16",a.offset=e,e+=2):f[o]>Math.pow(-2,31)&&(n.splice(n.length-1,0,{val:5,type:"Uint8",offset:e++}),a.type="Int32",a.offset=e,e+=4)):(f[o]=f[o].split("").map(function(t){return t.charCodeAt(0)}),n.push({val:f[o].length,type:"Uint8",offset:e++}),f[o].forEach(function(t){n.push({val:t,type:"Uint16",offset:e}),e+=2}))}),e},o=function(t,e,n){return a(t,e,n),e},a=function t(n,f,o){var a=void 0;if(f instanceof Object)return a=o instanceof DataView?o:new DataView(o instanceof ArrayBuffer?o:new Uint8Array(o).buffer),f instanceof Array&&(f.length=a.getUint8(n++),f.join().split(",").forEach(function(t,n){return f[n]=e(!0,{},f[0])})),f instanceof Array&&f[0]instanceof Object?f.forEach(function(e){return n=t(n,e,a)}):Object.keys(f).sort().forEach(function(e){if(f[e]instanceof Object)n=t(n,f[e],a);else if("number"===f[e])switch(a.getUint8(n++)){case 0:f[e]=a.getUint8(n),n+=1;break;case 1:f[e]=a.getInt8(n),n+=1;break;case 2:f[e]=a.getUint16(n),n+=2;break;case 3:f[e]=a.getInt16(n),n+=2;break;case 4:f[e]=a.getUint32(n),n+=4;break;case 5:f[e]=a.getInt32(n),n+=4;break;case 6:f[e]=a.getFloat32(n),n+=4;break;case 7:f[e]=a.getFloat64(n),n+=8}else f[e]=String.fromCharCode.apply(null,new Array(a.getUint8(n++)).join().split(",").map(function(){var t=a.getUint16(n);return n+=2,t}))}),n};t.encode=n,t.decode=o})("undefined"!=typeof module&&module.exports?module.exports:self.bufferify=self.bufferify||{});